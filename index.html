<style>
  body{
    position: absolute;
    background: white;
    width: 100%;
    height: 100%;
  }
</style>

<body>
  
  <canvas id="canva" width="300" height="300"></canvas>
  <button id="btn">Clear Canvas</button>
  
  <script>
    const canvas = document.getElementById("canva");
    let ctx = canvas.getContext('2d');
    ctx.canvas.width = 683;
    ctx.canvas.height = 457;
    
    let drawing = false;
    
    function bgImg (){
      const context = canvas.getContext('2d');
      context.clearRect(0, 0, 680, 460);
   }
    
   let flowerBTN = "Flower Off";
    
		function onoff(){
 			let currentvalue = document.getElementById('onoff').value;
  		if(currentvalue === "Flower Off"){
   			document.getElementById("onoff").value="Flower On";
        flowerBTN = "Flower Off";
 		 	}
      else{
    		document.getElementById("onoff").value="Flower Off";
        flowerBTN = "Flower On";
 			}
		}
    
    class Flowers{
      constructor(x,y,size){
        this.x = x;
        this.y = y;
        this.vs = Math.random() * 0.3;
        this.size = size;
        this.maxFlowerSize = this.size + Math.random() * 55;
        this.image = new Image();
        this.image.src = 'RetroFlowers.jpg';
        this.frameSize = 690;
        this.fX = Math.floor(Math.random() * 3);
        this.fY = Math.floor(Math.random() * 3);
        
        if (this.size > 5){
          this.willFlower = true;
        }
        else{
          this.willFlower = false;
        }
      }
      
      grow(){
        if (this.willFlower && (this.size < this.maxFlowerSize)){
          this.size += this.vs;
          ctx.drawImage(this.image, this.frameSize * this.fX, this.frameSize * this.fY, this.frameSize, this.frameSize, this.x - this.size / 2, this.y - this.size / 2, this.size, this.size);
        	requestAnimationFrame(this.grow.bind(this));
        }
      }
    }
    
    class Stem {
      constructor(x,y){
        this.x = x
        this.y = y
        this.speedX = Math.random()* 4 - 2;
        this.speedY = Math.random() * 4 - 2;
        this.maxSize = Math.random() * 8;
        this.size = Math.random() + 1.5 ;
        this.variedsize = Math.random() * 0.2 + 0.05;
        this.angleX = Math.random() * 6;
      	this.varX = Math.random() * 0.6 - 0.3;
        this.angleY = Math.random() * 6;
        this.varY = Math.random() * 0.6 - 0.3;
        this.lightness = 10;
      }
      
      update(){
        this.x += this.speedX + Math.sin(this.angleX);
        this.y += this.speedY + Math.sin(this.angleY);
        this.size += this.variedsize;
        this.angleX += this.varX;
        this.angleY += this.varY;
        
        
        if (this.lightness < 70){
          this.lightness += 0.25;
        }
        
        if (this.size < this.maxSize){
          ctx.beginPath();
          ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
          
        	let hue = 129;
  				let saturation = Math.floor(Math.random() * 50);
  				let lightness = 48;
  				ctx.fillStyle = 'hsl(' + hue + ',' + saturation + '%,' + lightness + '%)'
          
          // ctx.fillStyle = 'hsl(129, 'Math.random() * 20' %, 48%)';
          ctx.fill();
          ctx.stroke();
          requestAnimationFrame(this.update.bind(this));
        }
        else{
          const flowers = new Flowers(this.x, this.y, this.size);
          if (flowerBTN === "Flower On"){
        		flowers.grow();
          }
        }
   		 }
    }
    
    function setup(){
      document.body.style.backgroundImage =
        "url('https://cdn.shopify.com/s/files/1/1394/8105/files/sentinels_detail_600x600.jpg?v=1609965908.jpg?w=1380&t=st=1676307169~exp=1676307769~hmac=ec4286b43bc937d24e5bc8049ec0e6c1bd14edf20dcb3d14a3356bca07a7ece1')";
   		document.body.style.backgroundRepeat = "no-repeat";
      document.body.style.backgroundSize = "700px";
    }
    
    window.addEventListener('mousemove', function(e){
      
      if(drawing){
        for (let i = 0; i < 3; i++){
          const root = new Stem(e.x, e.y);
          root.update();
        }
      }
    });
    
    window.addEventListener('mousedown', function(e){
      drawing = true;
      for (let i = 0; i < 30; i++){
        const root = new Stem(e.x, e.y);
      	root.update();
      }
    });
    window.addEventListener('mouseup', function(){
      drawing = false;
    });
    
    window.addEventListener('load', setup);
    btn.addEventListener('click', bgImg)
    
  </script>
  
  <input type="button" value="Flower On" id="onoff" onclick="onoff();">
  
</body>

